Susan's decent newer code.
